daten_geraet = [
    {'datag_id': 1, 'geraet_id': 1, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-01 08:00:00',
     'energie': 100,
     'datas_id': '12345678'},
    {'datag_id': 2, 'geraet_id': 2, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-01 08:00:00',
     'energie': 150,
     'datas_id': None},
    {'datag_id': 3, 'geraet_id': 3, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-03 10:45:00',
     'energie': 120,
     'datas_id': None},
    {'datag_id': 4, 'geraet_id': 4, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-04 11:15:00',
     'energie': 130,
     'datas_id': None},
    {'datag_id': 5, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-05 12:30:00',
     'energie': 110,
     'datas_id': '12345678'},
    {'datag_id': 6, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-06 13:45:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 7, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-07 14:55:00',
     'energie': 125,
     'datas_id': None},
    {'datag_id': 8, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-08 15:20:00',
     'energie': 155,
     'datas_id': None},
    {'datag_id': 9, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-09 16:40:00',
     'energie': 145,
     'datas_id': '12345678'},
    {'datag_id': 10, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-10 17:10:00',
     'energie': 135,
     'datas_id': None},
    {'datag_id': 11, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-11 18:25:00',
     'energie': 115,
     'datas_id': None},
    {'datag_id': 12, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-12 19:40:00',
     'energie': 125,
     'datas_id': None},
    {'datag_id': 13, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-13 20:50:00',
     'energie': 105,
     'datas_id': '12345678'},
    {'datag_id': 14, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-14 21:15:00',
     'energie': 150,
     'datas_id': None},
    {'datag_id': 15, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-15 22:30:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 16, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-16 23:45:00',
     'energie': 130,
     'datas_id': None},
    {'datag_id': 17, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-17 14:55:00',
     'energie': 110,
     'datas_id': '12345678'},
    {'datag_id': 18, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-18 01:10:00',
     'energie': 135,
     'datas_id': None},
    {'datag_id': 19, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-19 02:25:00',
     'energie': 125,
     'datas_id': None},
    {'datag_id': 20, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-20 03:30:00',
     'energie': 160,
     'datas_id': None},
    {'datag_id': 21, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-21 04:45:00',
     'energie': 115,
     'datas_id': '12345678'},
    {'datag_id': 22, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-22 05:55:00',
     'energie': 105,
     'datas_id': None},
    {'datag_id': 23, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-23 06:10:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 24, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-24 07:25:00',
     'energie': 150,
     'datas_id': None},
    {'datag_id': 25, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-25 08:35:00',
     'energie': 120,
     'datas_id': '12345678'},
    {'datag_id': 26, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-26 09:50:00',
     'energie': 110,
     'datas_id': None},
    {'datag_id': 27, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-27 10:05:00',
     'energie': 130,
     'datas_id': None},
    {'datag_id': 28, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-28 11:20:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 29, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-29 12:30:00',
     'energie': 150,
     'datas_id': '12345678'},
    {'datag_id': 30, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-30 13:45:00',
     'energie': 160,
     'datas_id': None},
    {'datag_id': 31, 'geraet_id': 1, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-01 08:00:00',
     'energie': 110,
     'datas_id': '12345678'},
    {'datag_id': 32, 'geraet_id': 2, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-02 09:30:00',
     'energie': 120,
     'datas_id': None},
    {'datag_id': 33, 'geraet_id': 3, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-03 10:45:00',
     'energie': 130,
     'datas_id': None},
    {'datag_id': 34, 'geraet_id': 4, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-04 11:15:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 35, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-05 12:30:00',
     'energie': 150,
     'datas_id': '12345678'},
    {'datag_id': 36, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-06 13:45:00',
     'energie': 160,
     'datas_id': None},
    {'datag_id': 37, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-07 14:55:00',
     'energie': 110,
     'datas_id': None},
    {'datag_id': 38, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-08 15:20:00',
     'energie': 120,
     'datas_id': None},
    {'datag_id': 39, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-09 16:40:00',
     'energie': 130,
     'datas_id': '12345678'},
    {'datag_id': 40, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-10 17:10:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 41, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-11 18:25:00',
     'energie': 150,
     'datas_id': None},
    {'datag_id': 42, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-12 19:40:00',
     'energie': 110,
     'datas_id': None},
    {'datag_id': 43, 'geraet_id': 1, 'bereich': 'Bereich C', 'zeitstempel': '2023-12-13 20:50:00',
     'energie': 120,
     'datas_id': 12345678},
    {'datag_id': 44, 'geraet_id': 2, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-14 21:15:00',
     'energie': 130,
     'datas_id': None},
    {'datag_id': 45, 'geraet_id': 3, 'bereich': 'Bereich B', 'zeitstempel': '2023-12-15 22:30:00',
     'energie': 140,
     'datas_id': None},
    {'datag_id': 46, 'geraet_id': 4, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-16 23:45:00',
     'energie': 150,
     'datas_id': None},
    {'datag_id': 47, 'geraet_id': 1, 'bereich': 'Bereich A', 'zeitstempel': '2023-12-15 14:00:00',
     'energie': 160,
     'datas_id': 12345678}

]

daten_sensor = [
    {'datas_id': 12345678, 'sensor_id': 1, 'zeitstempel': '2023-12-15 14:00:00',
     'druck': 8.61051, 'durchfluss': 576.581, 'temperatur': 23.1144},
    {'datas_id': 4740499, 'sensor_id': 1, 'zeitstempel': '2023-12-16 11:15:20',
     'druck': 8.61012, 'durchfluss': 576.743, 'temperatur': 23.0789},
    {'datas_id': 4740500, 'sensor_id': 1, 'zeitstempel': '2023-12-17 12:30:45',
     'druck': 8.60998, 'durchfluss': 576.912, 'temperatur': 23.0657},
    {'datas_id': 4740501, 'sensor_id': 1, 'zeitstempel': '2023-12-18 13:45:10',
     'druck': 8.60987, 'durchfluss': 576.611, 'temperatur': 23.0912},
    {'datas_id': 4740502, 'sensor_id': 1, 'zeitstempel': '2023-12-19 14:55:55',
     'druck': 8.60972, 'durchfluss': 576.379, 'temperatur': 23.1285},
    {'datas_id': 4740503, 'sensor_id': 1, 'zeitstempel': '2023-12-20 16:10:40',
     'druck': 8.60958, 'durchfluss': 576.290, 'temperatur': 23.1416},
    {'datas_id': 4740504, 'sensor_id': 1, 'zeitstempel': '2023-12-21 17:25:05',
     'druck': 8.60942, 'durchfluss': 576.431, 'temperatur': 23.1053},
    {'datas_id': 4740505, 'sensor_id': 1, 'zeitstempel': '2023-12-22 18:35:22',
     'druck': 8.60937, 'durchfluss': 576.611, 'temperatur': 23.0764},
    {'datas_id': 4740506, 'sensor_id': 1, 'zeitstempel': '2023-12-23 19:45:50',
     'druck': 8.60929, 'durchfluss': 576.809, 'temperatur': 23.0497},
    {'datas_id': 4740507, 'sensor_id': 1, 'zeitstempel': '2023-12-24 20:55:15',
     'druck': 8.60915, 'durchfluss': 576.928, 'temperatur': 23.0344},
    {'datas_id': 4740508, 'sensor_id': 1, 'zeitstempel': '2023-12-25 22:10:30',
     'druck': 8.60902, 'durchfluss': 576.752, 'temperatur': 23.0721},
    {'datas_id': 4740509, 'sensor_id': 1, 'zeitstempel': '2023-12-26 23:25:45',
     'druck': 8.60897, 'durchfluss': 576.521, 'temperatur': 23.1129},
    {'datas_id': 4740510, 'sensor_id': 1, 'zeitstempel': '2023-12-27 00:40:00',
     'druck': 8.60888, 'durchfluss': 576.314, 'temperatur': 23.1486},
    {'datas_id': 4740511, 'sensor_id': 1, 'zeitstempel': '2023-12-28 01:50:25',
     'druck': 8.60875, 'durchfluss': 576.211, 'temperatur': 23.1645},
    {'datas_id': 4740512, 'sensor_id': 1, 'zeitstempel': '2023-12-29 03:05:40',
     'druck': 8.60863, 'durchfluss': 576.479, 'temperatur': 23.1198},
    {'datas_id': 4740513, 'sensor_id': 1, 'zeitstempel': '2023-12-30 04:20:55',
     'druck': 8.60857, 'durchfluss': 576.732, 'temperatur': 23.0797},
    {'datas_id': 4740514, 'sensor_id': 1, 'zeitstempel': '2023-12-31 05:35:10',
     'druck': 8.60849, 'durchfluss': 576.841, 'temperatur': 23.0632},
    {'datas_id': 4740515, 'sensor_id': 1, 'zeitstempel': '2024-01-01 06:45:35',
     'druck': 8.60836, 'durchfluss': 576.594, 'temperatur': 23.0974},
    {'datas_id': 4740516, 'sensor_id': 1, 'zeitstempel': '2024-01-02 08:00:50',
     'druck': 8.60822, 'durchfluss': 576.421, 'temperatur': 23.1294},
    {'datas_id': 4740517, 'sensor_id': 1, 'zeitstempel': '2024-01-03 09:15:15',
     'druck': 8.60815, 'durchfluss': 576.287, 'temperatur': 23.1453},
    {'datas_id': 4740518, 'sensor_id': 1, 'zeitstempel': '2024-01-04 10:30:30',
     'druck': 8.60807, 'durchfluss': 576.421, 'temperatur': 23.1257},
    {'datas_id': 4740498, 'sensor_id': 1, 'zeitstempel': '2023-12-15 10:59:35',
     'druck': 8.61051, 'durchfluss': 576.581, 'temperatur': 23.1144},
    {'datas_id': 4740505, 'sensor_id': 1, 'zeitstempel': '2023-12-05 12:30:00',
     'druck': 8.61052, 'durchfluss': 576.582, 'temperatur': 23.1145},
    {'datas_id': 4740510, 'sensor_id': 1, 'zeitstempel': '2023-12-27 00:40:00',
     'druck': 8.61053, 'durchfluss': 576.583, 'temperatur': 23.1146},
    {'datas_id': 4740515, 'sensor_id': 1, 'zeitstempel': '2024-01-01 06:45:35',
     'druck': 8.61054, 'durchfluss': 576.584, 'temperatur': 23.1147},
    {'datas_id': 4740518, 'sensor_id': 1, 'zeitstempel': '2024-01-04 10:30:30',
     'druck': 8.61055, 'durchfluss': 576.585, 'temperatur': 23.1148}
]


def merge_data(daten_geraet, daten_sensor):
    daten_komplett = []

    sensor_dict = {}
    for sensor_datensatz in daten_sensor:
        if sensor_datensatz['datas_id'] is not None:
            key = (sensor_datensatz['datas_id'], sensor_datensatz['zeitstempel'])
            sensor_dict[key] = sensor_datensatz

    for geraet_datensatz in daten_geraet:
        if geraet_datensatz['geraet_id'] == 1 and geraet_datensatz['datas_id'] is not None:
            key = (geraet_datensatz['datas_id'], geraet_datensatz['zeitstempel'])
            if key in sensor_dict:
                sensor_datensatz = sensor_dict[key]
                geraet_datensatz['druck'] = sensor_datensatz['druck']
                geraet_datensatz['durchfluss'] = sensor_datensatz['durchfluss']
                geraet_datensatz['temperatur'] = sensor_datensatz['temperatur']
            else:
                # Setze die Werte auf None, wenn kein passender Datensatz gefunden wird
                geraet_datensatz['druck'] = None
                geraet_datensatz['durchfluss'] = None
                geraet_datensatz['temperatur'] = None
        else:
            # Für Datensätze, die nicht geraet_id 1 entsprechen, oder keine datas_id haben
            geraet_datensatz['druck'] = None
            geraet_datensatz['durchfluss'] = None
            geraet_datensatz['temperatur'] = None

        daten_komplett.append(geraet_datensatz)

    return daten_komplett


daten_komplett = merge_data(daten_geraet, daten_sensor)
print(daten_komplett)

def bearbeite_datensaetze(daten_geraet):
    # Schritt 1: Zeilen löschen, wo geraet_id gleich 4 ist

    gesamt_energie_daten = {}
    for datensatz in daten_geraet:
        if datensatz['geraet_id']!= 4:
            zeitstempel = datensatz['zeitstempel']
            energie = datensatz['energie']
            if zeitstempel in gesamt_energie_daten:
                gesamt_energie_daten[zeitstempel] += energie
            else:
                gesamt_energie_daten[zeitstempel] = energie

    # Den neuen Datensatz "gesamt_energie_daten" erstellen
    gesamt_energie_datensaetze = []
    for zeitstempel, energie in gesamt_energie_daten.items():
        datensatz = {
            'geraet_id': 0,
            'zeitstempel': zeitstempel,
            'gesamt_energie': energie
        }
        gesamt_energie_datensaetze.append(datensatz)

    return gesamt_energie_datensaetze

gesamt_daten = bearbeite_datensaetze(daten_geraet)
print(gesamt_daten)